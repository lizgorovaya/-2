<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOOK SHOP</title>
    <link href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/catalog.css">
    <link rel="stylesheet" href="js/script.js">
</head>
<body>

<header>
    <div class="logo">
        <a href="/general.html" class="logo">
            <img src="images/logo.png" alt="BOOK SHOP Logo">
            <span>BOOK SHOP</span>
        </a>
    </div>
    <nav>
        <a href="general.html">Главная</a>
        <a href="catalog.html">Каталог</a>
        <a href="authors1.html">Авторы</a>
        <a href="#">Рекомендации</a>
    </nav>
    <div class="auth-buttons">
        <button class="login-btn">
            Войти
        </button>
        <a href="registration.html">
            <button class="register-btn">Зарегистрироваться</button>
        </a>
        
    </div>
</header>

<div class="button-container">
    <button class="button">СОРТИРОВАТЬ</button>
    <button class="button">ФИЛЬТРОВАТЬ</button>
</div>

<div class="books-container" id="books-container"></div>
<script>

// document.addEventListener("DOMContentLoaded", () => {
//     const container = document.getElementById("books-container");

//     fetch("http://localhost:8080/api/books/images")
//         .then(response => {
//             if (!response.ok) {
//                 throw new Error(`HTTP error! status: ${response.status}`);
//             }
//             return response.json();
//         })
//         .then(data => {
//             data.forEach(book => {
//                 if (book.image) {
//                     // Создаем контейнер для каждой книги
//                     const bookContainer = document.createElement("div");
//                     bookContainer.classList.add("book-item");

//                     // Создаем изображение книги
//                     const img = document.createElement("img");
//                     img.src = book.image; // Base64 строка изображения
//                     img.alt = "Book Cover";
//                     img.style.cursor = "pointer"; // Добавляем курсор для указания кликабельности

//                     // Создаем элемент для названия книги
//                     const title = document.createElement("div");
//                     title.classList.add("book-title");
//                     title.textContent = book.title; // Название книги

//                     // Добавляем обработчик клика по картинке
//                     img.addEventListener("click", () => {
//                         // Переход на страницу книги
//                         window.location.href = `/book/${book.id}`;
//                     });

//                     // Добавляем картинку и название в контейнер
//                     bookContainer.appendChild(img);
//                     bookContainer.appendChild(title);

//                     // Добавляем контейнер книги в основной контейнер
//                     container.appendChild(bookContainer);
//                 }
//             });
//         })
//         .catch(error => console.error("Error fetching book images:", error));
// });
document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("books-container");

    fetch("http://localhost:8080/api/books/images")
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            data.forEach(book => {
                if (book.image) {
                    // Создаем контейнер для каждой книги
                    const bookContainer = document.createElement("div");
                    bookContainer.classList.add("book-item");

                    // Создаем изображение книги
                    const img = document.createElement("img");
                    img.src = book.image; // Base64 строка изображения
                    img.alt = book.title || "Book Cover";
                    img.style.cursor = "pointer"; // Добавляем курсор для указания кликабельности

                    // Создаем элемент для названия книги
                    const title = document.createElement("div");
                    title.classList.add("book-title");
                    title.textContent = book.title || "Без названия"; // Название книги

                    // Добавляем обработчик клика по картинке
                    img.addEventListener("click", () => {
                        // Переход на страницу книги с переданным ID
                        window.location.href = `/book.html?id=${book.id}`;
                    });

                    // Добавляем картинку и название в контейнер
                    bookContainer.appendChild(img);
                    bookContainer.appendChild(title);

                    // Добавляем контейнер книги в основной контейнер
                    container.appendChild(bookContainer);
                }
            });
        })
        .catch(error => console.error("Error fetching book images:", error));
});

document.addEventListener('DOMContentLoaded', () => {
    const loginButton = document.querySelector('.login-btn');
    // Проверяем статус авторизации

    if (localStorage.getItem("isLoggedIn")) {
        loginButton.textContent = 'Выйти'; // Меняем текст кнопки
        loginButton.addEventListener('click', () => {
            localStorage.removeItem("isLoggedIn");
            window.location = "autorization.html";
            console.log("CHECK")
            // location.reload(); // Перезагрузка страницы
        });
    } else {
        loginButton.addEventListener('click', () => {
            window.location = "autorization.html";
        })
    }
});
</script>
<footer>
    <div class="logo">
        <a href="general.html">
            <img src="images/logo.png" alt="BOOK SHOP Logo">
        </a>
    </div>
</footer>